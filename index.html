<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ 2026 Ø£Ù†Ø±Ø§Ø²</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
  :root { --blue:#01429C; --blue-mid:#0252bf; --gold:#f0b429; --gray-100:#f1f3f5; --gray-200:#e9ecef; --gray-400:#adb5bd; --red:#e03131; --yellow:#f59f00; --green:#2f9e44; }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Cairo',sans-serif; background:var(--gray-100); direction:rtl; min-height:100vh; padding-bottom:60px; }

  .header { background:var(--blue); padding:18px 24px; text-align:center; border-bottom:4px solid var(--gold); }
  .header h1 { color:var(--gold); font-size:1.5rem; font-weight:900; }
  .header p { color:rgba(255,255,255,0.6); font-size:0.78rem; margin-top:3px; }

  .sync-bar { background:white; border-bottom:1px solid var(--gray-200); padding:6px 20px; display:flex; align-items:center; gap:8px; font-size:0.75rem; }
  .sync-dot { width:8px; height:8px; border-radius:50%; background:var(--gray-400); flex-shrink:0; }
  .sync-dot.online { background:var(--green); animation:pulse 2s infinite; }
  .sync-dot.syncing { background:var(--yellow); }
  .sync-dot.error { background:var(--red); }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }
  .sync-text { color:var(--gray-400); flex:1; }

  /* ADMIN BAR */
  .admin-bar { background:#f8f9ff; border-bottom:1px solid var(--gray-200); padding:6px 20px; display:flex; align-items:center; gap:10px; font-size:0.75rem; }
  .admin-badge { background:var(--blue); color:white; font-size:0.65rem; font-weight:900; padding:2px 10px; border-radius:20px; }
  .admin-badge.view { background:var(--gray-400); }
  .admin-btn { background:var(--gold); color:#1a1a2e; border:none; border-radius:7px; padding:5px 14px; font-family:'Cairo',sans-serif; font-size:0.75rem; font-weight:900; cursor:pointer; transition:all 0.2s; white-space:nowrap; }
  .admin-btn:hover { background:#d4991f; }
  .admin-btn.logout { background:var(--gray-200); color:#555; }
  .admin-btn.logout:hover { background:#dee2e6; }
  .share-btn { background:var(--blue); color:white; border:none; border-radius:7px; padding:5px 14px; font-family:'Cairo',sans-serif; font-size:0.75rem; font-weight:900; cursor:pointer; white-space:nowrap; }
  .share-btn:hover { background:var(--blue-mid); }

  /* LOGIN MODAL */
  .modal-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center; }
  .modal-overlay.show { display:flex; }
  .modal { background:white; border-radius:16px; padding:32px 28px; width:90%; max-width:360px; box-shadow:0 20px 60px rgba(0,0,0,0.3); text-align:center; }
  .modal h2 { color:var(--blue); font-size:1.2rem; font-weight:900; margin-bottom:6px; }
  .modal p { color:var(--gray-400); font-size:0.78rem; margin-bottom:20px; }
  .modal input { width:100%; border:2px solid var(--gray-200); border-radius:8px; padding:10px 14px; font-family:'Cairo',sans-serif; font-size:0.9rem; text-align:center; margin-bottom:12px; transition:border 0.2s; letter-spacing:3px; }
  .modal input:focus { outline:none; border-color:var(--blue); }
  .modal-submit { width:100%; background:var(--blue); color:white; border:none; border-radius:8px; padding:11px; font-family:'Cairo',sans-serif; font-size:0.9rem; font-weight:900; cursor:pointer; transition:background 0.2s; }
  .modal-submit:hover { background:var(--blue-mid); }
  .modal-error { color:var(--red); font-size:0.75rem; margin-top:8px; display:none; }
  .modal-cancel { background:none; border:none; color:var(--gray-400); font-family:'Cairo',sans-serif; font-size:0.75rem; cursor:pointer; margin-top:10px; display:block; width:100%; }

  /* VIEW BANNER */
  .view-banner { background:#fff8e1; border-bottom:1px solid #ffe082; padding:6px 20px; display:flex; align-items:center; justify-content:center; gap:8px; font-size:0.75rem; color:#b8860b; font-weight:700; }

  .share-toast { position:fixed; bottom:24px; left:50%; transform:translateX(-50%); background:#1a1a2e; color:white; padding:10px 20px; border-radius:8px; font-size:0.82rem; font-weight:700; z-index:999; opacity:0; transition:opacity 0.3s; pointer-events:none; white-space:nowrap; }
  .share-toast.show { opacity:1; }

  .container { max-width:980px; margin:0 auto; padding:20px 14px; }
  .tabs { display:flex; gap:4px; margin-bottom:18px; border-bottom:2px solid var(--gray-200); overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
  .tabs::-webkit-scrollbar { display:none; }
  .tab { background:none; border:none; font-family:'Cairo',sans-serif; font-size:0.85rem; font-weight:700; color:var(--gray-400); padding:10px 16px; cursor:pointer; border-bottom:3px solid transparent; margin-bottom:-2px; transition:all 0.2s; white-space:nowrap; flex-shrink:0; }
  .tab:hover { color:var(--blue); }
  .tab.active { color:var(--blue); border-bottom-color:var(--blue); }
  .panel { display:none; }
  .panel.active { display:block; }

  .card { background:white; border-radius:12px; overflow:hidden; box-shadow:0 2px 16px rgba(1,66,156,0.08); margin-bottom:16px; }
  .card-header { background:var(--blue); padding:11px 18px; color:var(--gold); font-size:0.95rem; font-weight:900; }

  .table-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; }
  table { width:100%; border-collapse:collapse; min-width:520px; }
  thead th { background:var(--blue); color:rgba(255,255,255,0.85); font-size:0.73rem; font-weight:700; padding:9px 8px; text-align:center; border-bottom:2px solid var(--gold); white-space:nowrap; }
  thead th:nth-child(2) { text-align:right; }
  tbody tr { border-bottom:1px solid var(--gray-200); transition:background 0.15s; }
  tbody tr:hover { background:#eef3fb; }
  tbody tr:nth-child(even) { background:#fafbfc; }
  tbody td { padding:10px 8px; text-align:center; font-size:0.85rem; color:#1a1a2e; vertical-align:middle; white-space:nowrap; }
  .rank { font-weight:900; color:var(--blue); font-size:1rem; }
  .rank-1 { color:#f59f00; } .rank-2 { color:#868e96; } .rank-3 { color:#cd6133; }
  .team-name-td { text-align:right !important; font-weight:800; font-size:0.9rem; }
  .pts { font-weight:900; font-size:1.05rem; color:var(--blue); }
  .form-dot { display:inline-block; width:17px; height:17px; border-radius:50%; font-size:0.58rem; font-weight:900; line-height:17px; text-align:center; color:white; margin:1px; }
  .form-w { background:var(--green); } .form-d { background:var(--gray-400); } .form-l { background:var(--red); }

  .month-label { font-size:0.72rem; font-weight:700; color:var(--gray-400); letter-spacing:0.08em; margin:14px 0 8px; }
  .match-card { background:white; border-radius:10px; box-shadow:0 2px 10px rgba(1,66,156,0.07); margin-bottom:10px; overflow:hidden; }
  .match-top { display:flex; align-items:center; gap:12px; padding:12px 16px; flex-wrap:wrap; }
  .match-day-badge { background:var(--blue); color:white; font-size:0.68rem; font-weight:900; padding:4px 10px; border-radius:6px; white-space:nowrap; flex-shrink:0; }
  .match-date { color:var(--gray-400); font-size:0.73rem; white-space:nowrap; flex-shrink:0; }
  .match-teams { display:flex; align-items:center; gap:10px; flex:1; justify-content:center; }
  .match-team-name { font-weight:800; font-size:0.88rem; flex:1; text-align:center; }
  .score-wrap { display:flex; align-items:center; gap:5px; }
  .score-input { width:42px; height:34px; border:2px solid var(--gray-200); border-radius:7px; text-align:center; font-family:'Cairo',sans-serif; font-size:1rem; font-weight:900; color:var(--blue); transition:border 0.2s; -moz-appearance:textfield; }
  .score-input::-webkit-outer-spin-button,.score-input::-webkit-inner-spin-button{-webkit-appearance:none;}
  .score-input:focus { outline:none; border-color:var(--blue); }
  .score-sep { font-weight:900; font-size:1rem; }
  .match-actions { display:flex; align-items:center; gap:8px; flex-shrink:0; }
  .save-btn { background:var(--blue); color:white; border:none; border-radius:7px; padding:7px 14px; font-family:'Cairo',sans-serif; font-size:0.78rem; font-weight:700; cursor:pointer; transition:background 0.2s; }
  .save-btn:hover { background:var(--blue-mid); }
  .save-btn.saved { background:var(--green); }
  .expand-btn { background:none; border:1.5px solid var(--gray-200); border-radius:7px; padding:6px 10px; font-family:'Cairo',sans-serif; font-size:0.75rem; font-weight:700; color:var(--gray-400); cursor:pointer; transition:all 0.2s; white-space:nowrap; }
  .expand-btn:hover,.expand-btn.open { border-color:var(--blue); color:var(--blue); background:#eef3fb; }
  .played-badge { font-size:0.65rem; font-weight:700; padding:2px 7px; border-radius:20px; background:#ebfbee; color:var(--green); border:1px solid var(--green); }
  .pending-badge { font-size:0.65rem; font-weight:700; padding:2px 7px; border-radius:20px; background:var(--gray-100); color:var(--gray-400); border:1px solid var(--gray-200); }

  .match-detail { display:none; border-top:1px solid var(--gray-200); padding:14px 16px; background:#fafbfc; }
  .match-detail.open { display:block; }
  .detail-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
  @media(max-width:520px){ .detail-grid { grid-template-columns:1fr; } }
  .team-detail-box { background:white; border-radius:8px; border:1px solid var(--gray-200); padding:12px; }
  .team-detail-title { font-weight:900; color:var(--blue); font-size:0.82rem; margin-bottom:10px; border-bottom:1px solid var(--gray-200); padding-bottom:6px; }
  .player-row { display:flex; align-items:center; justify-content:space-between; padding:5px 0; border-bottom:1px solid var(--gray-100); flex-wrap:wrap; gap:6px; }
  .player-row:last-child { border-bottom:none; }
  .player-name { font-size:0.78rem; font-weight:700; flex:1; color:#1a1a2e; min-width:80px; }
  .counter { display:flex; align-items:center; gap:4px; }
  .ctr-btn { width:22px; height:22px; border-radius:5px; border:none; cursor:pointer; font-size:0.85rem; font-weight:900; display:flex; align-items:center; justify-content:center; transition:all 0.15s; }
  .ctr-val { font-size:0.88rem; font-weight:900; min-width:18px; text-align:center; }
  .goal-btn { background:var(--green); color:white; } .goal-btn.minus{background:#dee2e6;color:#555;}
  .goal-val { color:var(--green); }
  .yellow-btn { background:var(--yellow); color:white; } .yellow-btn.minus{background:#dee2e6;color:#555;}
  .yellow-val { color:var(--yellow); }
  .red-btn { background:var(--red); color:white; } .red-btn.minus{background:#dee2e6;color:#555;}
  .red-val { color:var(--red); }
  .susp-btn { font-size:0.65rem; font-weight:700; padding:3px 8px; border-radius:20px; cursor:pointer; border:1px solid var(--gray-200); background:white; color:var(--gray-400); font-family:'Cairo',sans-serif; transition:all 0.2s; white-space:nowrap; }
  .susp-btn.on { background:var(--red); border-color:var(--red); color:white; }

  .scorer-row { display:flex; align-items:center; justify-content:space-between; padding:9px 18px; border-bottom:1px solid var(--gray-200); font-size:0.85rem; gap:6px; }
  .scorer-row:last-child { border-bottom:none; }
  .scorer-name { font-weight:700; }
  .scorer-team { color:var(--gray-400); font-size:0.75rem; flex:1; padding:0 6px; }
  .scorer-goals { font-weight:900; color:var(--green); font-size:1rem; }
  .susp-tag { background:var(--red); color:white; font-size:0.65rem; font-weight:700; padding:2px 8px; border-radius:20px; white-space:nowrap; }
  .loading { text-align:center; padding:30px; color:var(--gray-400); font-size:0.85rem; }

  /* DISABLED state for view mode */
  body.view-mode .score-input { pointer-events:none; background:var(--gray-100); color:var(--gray-400); }
  body.view-mode .save-btn,
  body.view-mode .expand-btn,
  body.view-mode .ctr-btn,
  body.view-mode .susp-btn { pointer-events:none; opacity:0.4; }
  body.view-mode .edit-tab { display:none; }
</style>
</head>
<body>

<!-- LOGIN MODAL -->
<div class="modal-overlay" id="login-modal">
  <div class="modal">
    <div style="font-size:2rem;margin-bottom:8px">ğŸ”</div>
    <h2>Ù†ØªØ§ Ù…Ù† Ø§Ù„Ù„Ø¬Ù†Ø© ØŸ</h2>
    <p>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</p>
    <input type="password" id="pw-input" placeholder="â— â— â— â— â— â—" onkeydown="if(event.key==='Enter')checkPassword()">
    <button class="modal-submit" onclick="checkPassword()">Ø¯Ø®ÙˆÙ„</button>
    <div class="modal-error" id="pw-error">Ù…ÙˆØ¯Ø¨Ø§Øµ ØºØ§Ù„Ø· ØŒØ­ØµÙ„ØªÙŠ Ø³ÙŠØ± ØªÙ„Ø¹Ø¨ Ù Ø¨Ù„Ø§ØµØ© Ø§Ø®Ø±Ù‰ âŒ</div>
    <button class="modal-cancel" onclick="closeLogin()">Ø¥Ù„ØºØ§Ø¡</button>
  </div>
</div>

<div class="header">
  <h1>ğŸ† Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ 2026 Ø£Ù†Ø±Ø§Ø² </h1>
  <p>ÙÙˆØ² = 3 Ù†Ù‚Ø§Ø· Â· ØªØ¹Ø§Ø¯Ù„ = 1 Ù†Ù‚Ø·Ø© Â· Ø®Ø³Ø§Ø±Ø© = 0 Ù†Ù‚Ø§Ø·</p>
</div>

<div class="view-banner" id="view-banner">
  ğŸ‘ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ â€” <span style="text-decoration:underline;cursor:pointer;margin-right:6px" onclick="openLogin()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¬Ù†Ø©
</span>
</div>

<div class="sync-bar">
  <div class="sync-dot" id="sync-dot"></div>
  <span class="sync-text" id="sync-text">Ø¬Ø§Ø±Ù Ø§Ù„Ø§ØªØµØ§Ù„...</span>
  <div style="display:flex;gap:8px;margin-right:auto;align-items:center">
    <button class="share-btn" onclick="shareViewLink()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
    <span id="admin-status" style="display:none">
      <span class="admin-badge">ğŸ”‘ Ù…Ø´Ø±Ù</span>
      <button class="admin-btn logout" onclick="logout()" style="margin-right:6px">Ø®Ø±ÙˆØ¬</button>
    </span>
  </div>
</div>
<div class="share-toast" id="share-toast">âœ“ ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©!</div>

<div class="container">
  <div class="tabs">
    <button class="tab active" onclick="switchTab('standings',this)">ğŸ† Ø§Ù„ØªØ±ØªÙŠØ¨</button>
    <button class="tab edit-tab" onclick="switchTab('matches',this)">ğŸ“… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù</button>
    <button class="tab edit-tab" onclick="switchTab('cardsinput',this)">ğŸŸ¨ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</button>
    <button class="tab" onclick="switchTab('scorers',this)">âš½ Ø§Ù„Ù‡Ø¯Ø§ÙÙˆÙ†</button>
    <button class="tab" onclick="switchTab('cardsview',this)">ğŸ“‹ Ø§Ù„Ø¥ÙŠÙ‚Ø§ÙØ§Øª</button>
  </div>

  <div class="panel active" id="panel-standings">
    <div class="card">
      <div class="card-header">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨</div>
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>#</th><th style="text-align:right">Ø§Ù„ÙØ±ÙŠÙ‚</th>
            <th>Ù„Ø¹Ø¨</th><th>ÙØ§Ø²</th><th>ØªØ¹Ø§Ø¯Ù„</th><th>Ø®Ø³Ø±</th>
            <th>Ù„Ù‡</th><th>Ø¹Ù„ÙŠÙ‡</th><th>ÙØ§Ø±Ù‚</th><th>Ù†Ù‚Ø§Ø·</th><th>Ø§Ù„Ø´ÙƒÙ„</th>
          </tr></thead>
          <tbody id="standings-body"><tr><td colspan="11" class="loading">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr></tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="panel" id="panel-matches">
    <div id="matches-list"><div class="loading">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div>
  </div>

  <div class="panel" id="panel-cardsinput">
    <div id="cards-input-list"><div class="loading">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div>
  </div>

  <div class="panel" id="panel-scorers">
    <div class="card">
      <div class="card-header">âš½ ØªØ±ØªÙŠØ¨ Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ†</div>
      <div id="scorers-body"><div class="loading">â³</div></div>
    </div>
  </div>

  <div class="panel" id="panel-cardsview">
    <div class="card" style="margin-bottom:16px">
      <div class="card-header">ğŸš« Ø§Ù„Ù…ÙˆÙ‚ÙˆÙÙˆÙ† Ù„Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</div>
      <div id="suspended-body"><div class="loading">â³</div></div>
    </div>
    <div class="card" style="margin-bottom:16px">
      <div class="card-header">ğŸŸ¥ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡</div>
      <div id="reds-body"><div class="loading">â³</div></div>
    </div>
    <div class="card">
      <div class="card-header">ğŸŸ¨ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙØ±Ø§Ø¡ Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠØ©</div>
      <div id="yellows-body"><div class="loading">â³</div></div>
    </div>
  </div>
</div>

<script>
// â”€â”€ SECURITY â”€â”€
// Change this password to whatever you want!
const ADMIN_PASSWORD = 'NGL2026admin';
const SESSION_KEY = 'ngl_admin_session';

let isAdmin = false;

function checkPassword() {
  const pw = document.getElementById('pw-input').value;
  if (pw === ADMIN_PASSWORD) {
    sessionStorage.setItem(SESSION_KEY, '1');
    isAdmin = true;
    applyAdminMode();
    closeLogin();
  } else {
    document.getElementById('pw-error').style.display = 'block';
    document.getElementById('pw-input').value = '';
    document.getElementById('pw-input').focus();
  }
}

function applyAdminMode() {
  document.body.classList.remove('view-mode');
  document.getElementById('view-banner').style.display = 'none';
  document.getElementById('admin-status').style.display = 'flex';
  document.getElementById('admin-status').style.alignItems = 'center';
}

function applyViewMode() {
  document.body.classList.add('view-mode');
  document.getElementById('view-banner').style.display = 'flex';
  document.getElementById('admin-status').style.display = 'none';
}

function openLogin() {
  document.getElementById('pw-input').value = '';
  document.getElementById('pw-error').style.display = 'none';
  document.getElementById('login-modal').classList.add('show');
  setTimeout(() => document.getElementById('pw-input').focus(), 100);
}

function closeLogin() {
  document.getElementById('login-modal').classList.remove('show');
}

function logout() {
  sessionStorage.removeItem(SESSION_KEY);
  isAdmin = false;
  applyViewMode();
  // Switch to standings tab
  document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.querySelector('.tab').classList.add('active');
  document.getElementById('panel-standings').classList.add('active');
}

// Close modal on overlay click
document.getElementById('login-modal').addEventListener('click', function(e) {
  if (e.target === this) closeLogin();
});

// â”€â”€ SUPABASE â”€â”€
const SUPABASE_URL = 'https://reksuhcvliwqjorpssou.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJla3N1aGN2bGl3cWpvcnBzc291Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2MzM1MjYsImV4cCI6MjA4NzIwOTUyNn0.Nn1dIGX035AUFuUk9v6zaldjIC6ZHyxeD5rVoIUYPDk';

const TEAMS_LIST = ['Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„','Ø§Ù„Ø±Ø³ÙŠÙ†Øº','Ø§Ù„Ø®ÙØ§ÙÙŠØ´','ØªÙˆØ±ÙŠØ±Øª','ØªØ§Ø±ÙŠØ­Ø§Ù†Øª','Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯','Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ'];
const PLAYERS = {
  'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„':['Ø®Ø§Ù„Ø¯ Ø£ÙŠØª Ù…Ø­Ù†Ø¯','Ø¥Ø¯Ø±ÙŠØ³ Ø§Ù„Ø­ÙŠØ§Ù†','Ø¹Ø§Ø¯Ù„ Ø£ÙŠØª Ù…Ø­Ù†Ø¯','Ù…ØµØ·ÙÙ‰ Ø£ÙŠØª Ø£Ù…ØºØ§Ø±','Ù…Ù†ÙŠØ± Ø£ÙŠØª Ø§Ù„Ø­Ø³Ù† Ø§Ø¹Ù„ÙŠ','Ù…Ø­Ù…Ø¯ Ø£ÙŠØª Ø£Ù…ØºØ§Ø±','Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ø£ÙŠØª Ù…Ø­Ù†Ø¯','Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¨Ù„ÙÙ‚ÙŠÙ‡','Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ø£ÙŠØª Ù…Ø­Ù†Ø¯ Ø¨Ù† Ø¹Ù…Ø±','Ø§Ù„Ø­Ø³ÙŠÙ† Ø£ÙŠØª Ù…Ø­Ù†Ø¯'],
  'Ø§Ù„Ø±Ø³ÙŠÙ†Øº':['Ø¹Ù…Ø± Ø§Ø¯Ù†Ø§Ø³','ÙƒØ±ÙŠÙ… Ù…Ù†ØµÙˆØ±','Ø­Ø³Ù† ÙˆÙƒØ±ÙŠÙ…','Ø¥Ù„ÙŠØ§Ø³ Ø§Ø¯Ù†Ø§Ø³','Ø±Ø´ÙŠØ¯ Ø¨Ù† Ø­Ø¯ÙˆØ´','Ø§Ø³Ø§Ù…Ø© Ø§Ø®Ø±Ø§Ø²','Ø­Ø³Ù† Ø¨Ø±Ù†Ùˆ','Ù…ØµØ·ÙÙ‰ Ù„Ø¯ÙŠØ¨','Ø®Ø§Ù„Ø¯ Ø¨Ø¯Ø§Ø±ÙŠ'],
  'Ø§Ù„Ø®ÙØ§ÙÙŠØ´':['Ø²ÙƒØ±ÙŠØ§Ø¡ Ø¨Ø±Ù†Ùˆ','Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø²Ø§Ù‚ Ø§ÙŠØª Ø£ÙˆØ¨Ù‡','Ø¹Ø§Ø¯Ù„ Ø§Ù…Ø²ÙŠÙ„','Ø§Ø¯Ø§Ù… Ø¨ÙˆÙŠØ³Ù„Ù…Ø§Ù†','Ø§Ù„Ø­Ø³Ù† Ø§ÙŠØª Ù…Ø­Ù†Ø¯','Ù…Ø¬ÙŠØ¯ Ø§ÙŠØª Ù†Ø¬Ù…Ø§ Ø­Ù…Ùˆ','Ø­Ø³Ù† Ø§ÙˆØºØ¯Ùˆ','Ø§Ø´Ø±Ø§Ù Ø§ÙÙˆØ±ÙŠØ±'],
  'ØªÙˆØ±ÙŠØ±Øª':['Ø§Ù„Ø±Ø§ÙŠØ³ Ù…Ø­Ù…Ø¯','Ø§Ù„Ø±Ø§ÙŠØ³ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ…','Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ø¯Ø­Ù…Ø§Ø¯','Ø§Ù„Ø­Ø¯Ø§Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø­ÙŠ','Ø§Ø¨ÙˆØ¬Ù…Ø¹Ø© Ø³Ø¹ÙŠØ¯','Ø±Ø¶ÙˆØ§Ù† Ø§Ø¯Ø­Ù…Ø§Ø¯','ÙØ±ÙŠØ¯ Ø§Ø¯Ø¨Ù„Ø§','Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø§Ù„Ù…Ø¹Ù„Ø§Ù…','Ù…ØµØ·ÙÙ‰ Ø¨Ù†ÙˆØ§Ø¶Ø±'],
  'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª':['ÙŠØ§Ø³ÙŠÙ† Ø§Ø¨Ø®Ø§Ø±','Ø¹Ø¨Ø¯ Ø§Ù„Ø§Ù„Ù‡ Ø§ÙŠØª Ù„Ø­Ø³Ù†','Ø§ÙŠÙˆØ¨ Ø´ÙƒØ±Ø·','Ø§Ù…ÙŠÙ† Ø§ÙŠØª Ø§Ù…ØºØ§Ø±','Ø­Ø³Ù† Ø§ÙŠØª Ù…Ø­Ù†Ø¯','Ø­Ù…ÙŠØ¯ Ø§ÙŠØª ØªØ¯Ø§Ø±Øª','Ù…ØµØ·ÙÙ‰ Ù…ÙØ§Ù…Ø§Ù†','Ù„Ø­Ø³Ù† Ø¨Ù„ÙÙ‚ÙŠÙ‡'],
  'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯':['Ø§Ù„ÙŠØ§Ø³ Ø§Ø­Ø´Ù…ÙŠÙ†Ø§Ù†','Ø³Ø¹ÙŠØ¯ Ø§ÙŠØª Ø¨Ù„Ø¹ÙŠØ¯','Ø­Ø³Ù† Ø§ÙŠØª Ø¨Ù„Ø¹ÙŠØ¯','Ù…Ø­Ù…Ø¯ Ø¨Ø§Ùˆ','Ø³Ù…ÙŠØ± Ø§Ù„ØªÙÙ†ÙˆØªÙŠ','Ø¹Ù…Ø± Ø£ÙŠØª Ø³Ø¹ÙŠØ¯'],
  'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ':['Ø¹Ø¨Ø¯Ø§Ù„ÙƒØ±ÙŠÙ… Ø§ÙŠØª Ø£Ù…Ø®Ø§ÙŠÙ†','Ù…Ø­Ù…Ø¯ ØªÙ„Ø­ÙŠÙ‚','Ø¹Ø¨Ø¯Ø§Ù„Ø±ÙÙŠØ¹ Ø¨ÙˆØªØ´ÙŠØ´','Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ù„ÙŠ Ù…Ø±Ø²ÙˆÙƒ','ÙŠÙˆÙ†Ø³ Ø£Ø¬ÙƒÙ†ÙŠ','Ù…Ø­Ù…Ø¯ Ø£ÙŠØª ØªÙ„Ø§Øª','Ø¥Ù„ÙŠØ§Ø³ ÙƒÙˆÙˆÙŠØ±ÙƒØ§Ù†','ÙŠØ§Ø³ÙŠÙ† Ø£Ø¬ÙƒÙ†ÙŠ'],
};
const MATCHES = [
  {day:1,date:'21 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„',away:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº'},
  {day:2,date:'22 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´',away:'ØªÙˆØ±ÙŠØ±Øª'},
  {day:3,date:'23 ÙØ¨Ø±Ø§ÙŠØ±',home:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª',away:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯'},
  {day:4,date:'24 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ',away:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„'},
  {day:5,date:'25 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº',away:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´'},
  {day:6,date:'26 ÙØ¨Ø±Ø§ÙŠØ±',home:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª',away:'ØªÙˆØ±ÙŠØ±Øª'},
  {day:7,date:'27 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯',away:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ'},
  {day:8,date:'28 ÙØ¨Ø±Ø§ÙŠØ±',home:'ØªÙˆØ±ÙŠØ±Øª',away:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„'},
  {day:9,date:'29 ÙØ¨Ø±Ø§ÙŠØ±',home:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº',away:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯'},
  {day:10,date:'1 Ù…Ø§Ø±Ø³',home:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª',away:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´'},
  {day:11,date:'2 Ù…Ø§Ø±Ø³',home:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„',away:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯'},
  {day:12,date:'3 Ù…Ø§Ø±Ø³',home:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ',away:'ØªÙˆØ±ÙŠØ±Øª'},
  {day:13,date:'4 Ù…Ø§Ø±Ø³',home:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª',away:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„'},
  {day:14,date:'5 Ù…Ø§Ø±Ø³',home:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº',away:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ'},
  {day:15,date:'6 Ù…Ø§Ø±Ø³',home:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯',away:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´'},
  {day:16,date:'7 Ù…Ø§Ø±Ø³',home:'ØªÙˆØ±ÙŠØ±Øª',away:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº'},
  {day:17,date:'8 Ù…Ø§Ø±Ø³',home:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª',away:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ'},
  {day:18,date:'9 Ù…Ø§Ø±Ø³',home:'Ø¥Ù…Ø¯ÙˆÙƒØ§Ù„',away:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´'},
  {day:19,date:'10 Ù…Ø§Ø±Ø³',home:'Ø£ØªÙ„Ø§ØªÙŠÙƒ Ø·ÙˆØ±ÙˆØ±Ø¯',away:'ØªÙˆØ±ÙŠØ±Øª'},
  {day:20,date:'11 Ù…Ø§Ø±Ø³',home:'Ø§Ù„Ø±Ø³ÙŠÙ†Øº',away:'ØªØ§Ø±ÙŠØ­Ø§Ù†Øª'},
  {day:21,date:'12 Ù…Ø§Ø±Ø³',home:'Ø¥ØªØ­Ø§Ø¯ Ø£ÙƒÙ†ÙŠ',away:'Ø§Ù„Ø®ÙØ§ÙÙŠØ´'},
];

let matchResults={}, playerStats={};

async function sbGet(path) {
  const res = await fetch(`${SUPABASE_URL}/rest/v1/${path}`, { headers:{'apikey':SUPABASE_KEY,'Authorization':`Bearer ${SUPABASE_KEY}`} });
  if(!res.ok) throw new Error(`${res.status} ${await res.text()}`);
  return res.json();
}
async function sbUpsert(table, body) {
  if(!isAdmin) { alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ ÙƒÙ…Ø´Ø±Ù'); return; }
  const res = await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {
    method:'POST',
    headers:{'apikey':SUPABASE_KEY,'Authorization':`Bearer ${SUPABASE_KEY}`,'Content-Type':'application/json','Prefer':'resolution=merge-duplicates,return=minimal'},
    body:JSON.stringify(body)
  });
  if(!res.ok) throw new Error(`${res.status} ${await res.text()}`);
}

function setSyncStatus(s,t) {
  document.getElementById('sync-dot').className='sync-dot '+s;
  document.getElementById('sync-text').textContent=t;
}

async function loadAll() {
  try {
    setSyncStatus('syncing','Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
    const [results,stats] = await Promise.all([sbGet('match_results?select=*'),sbGet('player_stats?select=*')]);
    matchResults={};
    results.forEach(r=>{ matchResults[r.match_idx]=r; });
    playerStats={};
    stats.forEach(s=>{ playerStats[`${s.match_idx}-${s.side}-${s.player_name}`]=s; });
    setSyncStatus('online','ğŸŸ¢ Ù…ØªØµÙ„ Â· ÙŠØªØ­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
    renderAll();
  } catch(e) { setSyncStatus('error','ğŸ”´ Ø®Ø·Ø£: '+e.message); }
}

async function saveMatchResult(idx) {
  if(!isAdmin) { openLogin(); return; }
  const h=document.getElementById('h-'+idx).value, a=document.getElementById('a-'+idx).value;
  if(h===''||a==='') return;
  setSyncStatus('syncing','â³ Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...');
  try {
    await sbUpsert('match_results',{match_idx:idx,home_score:parseInt(h),away_score:parseInt(a)});
    matchResults[idx]={match_idx:idx,home_score:parseInt(h),away_score:parseInt(a)};
    setSyncStatus('online','ğŸŸ¢ ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ“');
    renderAll();
  } catch(e) { setSyncStatus('error','ğŸ”´ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: '+e.message); }
}

function getPS(idx,side,player) {
  const key=`${idx}-${side}-${player}`;
  if(!playerStats[key]) playerStats[key]={goals:0,yellows:0,reds:0,suspended:false};
  return playerStats[key];
}

async function savePS(idx,side,player) {
  if(!isAdmin) { openLogin(); return; }
  const d=getPS(idx,side,player);
  setSyncStatus('syncing','â³ Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...');
  try {
    await sbUpsert('player_stats',{match_idx:idx,side,player_name:player,goals:d.goals||0,yellows:d.yellows||0,reds:d.reds||0,suspended:d.suspended||false});
    setSyncStatus('online','ğŸŸ¢ ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ“');
    renderScorers(); renderCardsView();
  } catch(e) { setSyncStatus('error','ğŸ”´ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: '+e.message); }
}

function changeGoal(idx,side,player,delta) {
  if(!isAdmin){openLogin();return;}
  const d=getPS(idx,side,player);
  d.goals=Math.max(0,(d.goals||0)+delta);
  const el=document.getElementById(`gv-${idx}-${side}-${player}`);
  if(el) el.textContent=d.goals;
  savePS(idx,side,player);
}

function changeCard(idx,side,player,field,delta) {
  if(!isAdmin){openLogin();return;}
  const d=getPS(idx,side,player);
  d[field]=Math.max(0,(d[field]||0)+delta);
  const el=document.getElementById(`cv-${idx}-${side}-${player}-${field}`);
  if(el) el.textContent=d[field];
  if(field==='reds'){
    d.suspended=d.reds>0;
    const sb=document.getElementById(`cs-${idx}-${side}-${player}`);
    if(sb){sb.textContent=d.suspended?'ğŸš« Ù…ÙˆÙ‚ÙˆÙ':'Ù„Ø§';sb.classList.toggle('on',d.suspended);}
  }
  savePS(idx,side,player);
}

function toggleSusp(idx,side,player) {
  if(!isAdmin){openLogin();return;}
  const d=getPS(idx,side,player);
  d.suspended=!d.suspended;
  const sb=document.getElementById(`cs-${idx}-${side}-${player}`);
  if(sb){sb.textContent=d.suspended?'ğŸš« Ù…ÙˆÙ‚ÙˆÙ':'Ù„Ø§';sb.classList.toggle('on',d.suspended);}
  savePS(idx,side,player);
}

function toggleDetail(idx) {
  const el=document.getElementById('detail-'+idx),btn=document.getElementById('expand-'+idx);
  const open=el.classList.toggle('open');
  btn.classList.toggle('open',open);
  btn.textContent=open?'âˆ’ Ø¥ØºÙ„Ø§Ù‚':'+ Ø£Ù‡Ø¯Ø§Ù';
}
function toggleCardDetail(idx) {
  const el=document.getElementById('cdetail-'+idx),btn=document.getElementById('cexpand-'+idx);
  const open=el.classList.toggle('open');
  btn.classList.toggle('open',open);
  btn.textContent=open?'âˆ’ Ø¥ØºÙ„Ø§Ù‚':'+ Ø¨Ø·Ø§Ù‚Ø§Øª';
}

function renderAll() { renderMatches(); renderCardsInput(); renderStandings(); renderScorers(); renderCardsView(); }

function renderMatches() {
  let html='',curMonth='';
  MATCHES.forEach((m,idx)=>{
    const month=m.date.includes('ÙØ¨Ø±Ø§ÙŠØ±')?'ğŸ“… ÙØ¨Ø±Ø§ÙŠØ± 2026':'ğŸ“… Ù…Ø§Ø±Ø³ 2026';
    if(month!==curMonth){curMonth=month;html+=`<div class="month-label">${month}</div>`;}
    const r=matchResults[idx];
    const played=r&&r.home_score!==null&&r.home_score!==undefined;
    const hVal=played?r.home_score:'',aVal=played?r.away_score:'';
    const badge=played?'<span class="played-badge">âœ“ Ù…Ø³Ø¬Ù„</span>':'<span class="pending-badge">Ù„Ù… ÙŠÙ„Ø¹Ø¨</span>';

    let detail=`<div class="match-detail" id="detail-${idx}"><div class="detail-grid">`;
    ['home','away'].forEach(side=>{
      const team=m[side],players=PLAYERS[team]||[];
      detail+=`<div class="team-detail-box"><div class="team-detail-title">âš½ ${team}</div>`;
      players.forEach(p=>{
        const d=getPS(idx,side,p);
        detail+=`<div class="player-row">
          <span class="player-name">${p}</span>
          <div class="counter">
            <button class="ctr-btn goal-btn minus" onclick="changeGoal(${idx},'${side}','${p}',-1)">âˆ’</button>
            <span class="ctr-val goal-val" id="gv-${idx}-${side}-${p}">${d.goals||0}</span>
            <button class="ctr-btn goal-btn" onclick="changeGoal(${idx},'${side}','${p}',1)">+</button>
          </div>
        </div>`;
      });
      detail+='</div>';
    });
    detail+='</div></div>';

    html+=`<div class="match-card">
      <div class="match-top">
        <div class="match-day-badge">Ù…${m.day}</div>
        <div class="match-date">${m.date}</div>
        <div class="match-teams">
          <div class="match-team-name">${m.home}</div>
          <div class="score-wrap">
            <input class="score-input" type="number" min="0" id="h-${idx}" value="${hVal}" placeholder="-">
            <span class="score-sep">:</span>
            <input class="score-input" type="number" min="0" id="a-${idx}" value="${aVal}" placeholder="-">
          </div>
          <div class="match-team-name">${m.away}</div>
        </div>
        ${badge}
        <div class="match-actions">
          <button class="save-btn ${played?'saved':''}" onclick="saveMatchResult(${idx})">${played?'âœ“ ØªØ­Ø¯ÙŠØ«':'Ø­ÙØ¸'}</button>
          <button class="expand-btn" id="expand-${idx}" onclick="toggleDetail(${idx})">+ Ø£Ù‡Ø¯Ø§Ù</button>
        </div>
      </div>
      ${detail}
    </div>`;
  });
  document.getElementById('matches-list').innerHTML=html;
}

function renderCardsInput() {
  let html='',curMonth='';
  MATCHES.forEach((m,idx)=>{
    const month=m.date.includes('ÙØ¨Ø±Ø§ÙŠØ±')?'ğŸ“… ÙØ¨Ø±Ø§ÙŠØ± 2026':'ğŸ“… Ù…Ø§Ø±Ø³ 2026';
    if(month!==curMonth){curMonth=month;html+=`<div class="month-label">${month}</div>`;}
    const r=matchResults[idx];
    const played=r&&r.home_score!==null&&r.home_score!==undefined;
    const badge=played?`<span class="played-badge">${r.home_score} - ${r.away_score}</span>`:'<span class="pending-badge">Ù„Ù… ÙŠÙ„Ø¹Ø¨</span>';

    let detail=`<div class="match-detail" id="cdetail-${idx}"><div class="detail-grid">`;
    ['home','away'].forEach(side=>{
      const team=m[side],players=PLAYERS[team]||[];
      detail+=`<div class="team-detail-box"><div class="team-detail-title">${team}</div>`;
      players.forEach(p=>{
        const d=getPS(idx,side,p);
        detail+=`<div class="player-row">
          <span class="player-name">${p}</span>
          <div class="counter">
            <button class="ctr-btn yellow-btn minus" onclick="changeCard(${idx},'${side}','${p}','yellows',-1)">âˆ’</button>
            <span class="ctr-val yellow-val" id="cv-${idx}-${side}-${p}-yellows">${d.yellows||0}</span>
            <button class="ctr-btn yellow-btn" onclick="changeCard(${idx},'${side}','${p}','yellows',1)">ğŸŸ¨</button>
          </div>
          <div class="counter">
            <button class="ctr-btn red-btn minus" onclick="changeCard(${idx},'${side}','${p}','reds',-1)">âˆ’</button>
            <span class="ctr-val red-val" id="cv-${idx}-${side}-${p}-reds">${d.reds||0}</span>
            <button class="ctr-btn red-btn" onclick="changeCard(${idx},'${side}','${p}','reds',1)">ğŸŸ¥</button>
          </div>
          <button class="susp-btn ${d.suspended?'on':''}" id="cs-${idx}-${side}-${p}" onclick="toggleSusp(${idx},'${side}','${p}')">${d.suspended?'ğŸš« Ù…ÙˆÙ‚ÙˆÙ':'Ù„Ø§'}</button>
        </div>`;
      });
      detail+='</div>';
    });
    detail+='</div></div>';

    html+=`<div class="match-card">
      <div class="match-top">
        <div class="match-day-badge">Ù…${m.day}</div>
        <div class="match-date">${m.date}</div>
        <div class="match-teams">
          <div class="match-team-name">${m.home}</div>
          <span class="score-sep" style="color:var(--gray-400)">vs</span>
          <div class="match-team-name">${m.away}</div>
        </div>
        ${badge}
        <div class="match-actions">
          <button class="expand-btn" id="cexpand-${idx}" onclick="toggleCardDetail(${idx})">+ Ø¨Ø·Ø§Ù‚Ø§Øª</button>
        </div>
      </div>
      ${detail}
    </div>`;
  });
  document.getElementById('cards-input-list').innerHTML=html;
}

function renderStandings() {
  const stats={};
  TEAMS_LIST.forEach(t=>{stats[t]={p:0,w:0,d:0,l:0,gf:0,ga:0,pts:0,form:[]};});
  MATCHES.forEach((m,idx)=>{
    const r=matchResults[idx];
    if(!r||r.home_score===null||r.home_score===undefined) return;
    const hg=r.home_score,ag=r.away_score,hs=stats[m.home],as_=stats[m.away];
    hs.p++;as_.p++;hs.gf+=hg;hs.ga+=ag;as_.gf+=ag;as_.ga+=hg;
    if(hg>ag){hs.w++;hs.pts+=3;as_.l++;hs.form.push('W');as_.form.push('L');}
    else if(hg<ag){as_.w++;as_.pts+=3;hs.l++;hs.form.push('L');as_.form.push('W');}
    else{hs.d++;hs.pts++;as_.d++;as_.pts++;hs.form.push('D');as_.form.push('D');}
  });
  const sorted=Object.entries(stats).map(([name,s])=>({name,...s,gd:s.gf-s.ga})).sort((a,b)=>b.pts-a.pts||b.gd-a.gd||b.gf-a.gf);
  document.getElementById('standings-body').innerHTML=sorted.map((t,i)=>{
    const r=i+1,rc=r===1?'rank rank-1':r===2?'rank rank-2':r===3?'rank rank-3':'rank';
    const form=t.form.slice(-5).map(f=>`<span class="form-dot form-${f.toLowerCase()}">${f==='W'?'Ù':f==='D'?'Øª':'Ø®'}</span>`).join('');
    const gd=t.gd>0?'+'+t.gd:t.gd;
    return `<tr><td><span class="${rc}">${r}</span></td><td class="team-name-td">${t.name}</td>
      <td>${t.p}</td><td>${t.w}</td><td>${t.d}</td><td>${t.l}</td>
      <td>${t.gf}</td><td>${t.ga}</td><td>${t.p>0?gd:'-'}</td>
      <td><span class="pts">${t.pts}</span></td><td>${form||'-'}</td></tr>`;
  }).join('');
}

function renderScorers() {
  const totals={};
  MATCHES.forEach((m,idx)=>['home','away'].forEach(side=>(PLAYERS[m[side]]||[]).forEach(p=>{
    const d=getPS(idx,side,p);
    if(!totals[p]) totals[p]={goals:0,team:m[side]};
    totals[p].goals+=(d.goals||0);
  })));
  const sorted=Object.entries(totals).filter(([,v])=>v.goals>0).sort((a,b)=>b[1].goals-a[1].goals);
  document.getElementById('scorers-body').innerHTML=sorted.length
    ?sorted.map(([name,v],i)=>`<div class="scorer-row"><span class="scorer-name">${i+1}. ${name}</span><span class="scorer-team">${v.team}</span><span class="scorer-goals">âš½ ${v.goals}</span></div>`).join('')
    :'<div class="scorer-row" style="color:#aaa;justify-content:center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‡Ø¯Ø§Ù Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯</div>';
}

function renderCardsView() {
  const suspended=[],yellows={},reds={};
  MATCHES.forEach((m,idx)=>['home','away'].forEach(side=>(PLAYERS[m[side]]||[]).forEach(p=>{
    const d=getPS(idx,side,p);
    if(d.suspended) suspended.push({p,team:m[side]});
    if(!yellows[p]) yellows[p]={count:0,team:m[side]};
    yellows[p].count+=(d.yellows||0);
    if(!reds[p]) reds[p]={count:0,team:m[side]};
    reds[p].count+=(d.reds||0);
  })));
  const suspUniq=[...new Map(suspended.map(s=>[s.p,s])).values()];
  document.getElementById('suspended-body').innerHTML=suspUniq.length
    ?suspUniq.map(s=>`<div class="scorer-row"><span class="scorer-name">${s.p}</span><span class="scorer-team">${s.team}</span><span class="susp-tag">ğŸš« Ù…ÙˆÙ‚ÙˆÙ</span></div>`).join('')
    :'<div class="scorer-row" style="color:#aaa;justify-content:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆÙ‚ÙˆÙÙˆÙ†</div>';
  const sortedR=Object.entries(reds).filter(([,v])=>v.count>0).sort((a,b)=>b[1].count-a[1].count);
  document.getElementById('reds-body').innerHTML=sortedR.length
    ?sortedR.map(([name,v],i)=>`<div class="scorer-row"><span class="scorer-name">${i+1}. ${name}</span><span class="scorer-team">${v.team}</span><span class="scorer-goals" style="color:var(--red)">ğŸŸ¥ ${v.count}</span></div>`).join('')
    :'<div class="scorer-row" style="color:#aaa;justify-content:center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª Ø­Ù…Ø±Ø§Ø¡</div>';
  const sortedY=Object.entries(yellows).filter(([,v])=>v.count>0).sort((a,b)=>b[1].count-a[1].count);
  document.getElementById('yellows-body').innerHTML=sortedY.length
    ?sortedY.map(([name,v],i)=>`<div class="scorer-row"><span class="scorer-name">${i+1}. ${name}</span><span class="scorer-team">${v.team}</span><span class="scorer-goals" style="color:var(--yellow)">ğŸŸ¨ ${v.count}</span></div>`).join('')
    :'<div class="scorer-row" style="color:#aaa;justify-content:center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡</div>';
}

function shareViewLink() {
  const link = location.origin + location.pathname;
  navigator.clipboard.writeText(link).then(()=>{
    const t=document.getElementById('share-toast');t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500);
  }).catch(()=>prompt('Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:',link));
}

function switchTab(name,btn) {
  document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('panel-'+name).classList.add('active');
}

// â”€â”€ INIT â”€â”€
// Check session
if (sessionStorage.getItem(SESSION_KEY) === '1') {
  isAdmin = true;
  applyAdminMode();
} else {
  applyViewMode();
}

loadAll();
setInterval(loadAll, 30000);
</script>
</body>
</html>
